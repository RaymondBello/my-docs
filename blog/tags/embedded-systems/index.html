<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Ray RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Ray Atom Feed">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" integrity="sha384-Um5gpz1odJg5Z4HAmzPtgZKdTBHZdw8S29IecapCSB31ligYPhHQZMIlWLYQGVoc" crossorigin="anonymous"><title data-react-helmet="true">4 posts tagged with &quot;embedded-systems&quot; | Ray</title><meta data-react-helmet="true" property="og:title" content="4 posts tagged with &quot;embedded-systems&quot; | Ray"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://RaymondBello.github.io/blog/tags/embedded-systems"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_tag" content="blog_tags_posts"><link data-react-helmet="true" rel="icon" href="https://img.icons8.com/metro/26/000000/r.png"><link data-react-helmet="true" rel="canonical" href="https://RaymondBello.github.io/blog/tags/embedded-systems"><link data-react-helmet="true" rel="alternate" href="https://RaymondBello.github.io/blog/tags/embedded-systems" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://RaymondBello.github.io/blog/tags/embedded-systems" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.f61b5f7d.css">
<link rel="preload" href="/assets/js/runtime~main.fb2dc35f.js" as="script">
<link rel="preload" href="/assets/js/main.35de6d16.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top navbar--dark"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="https://img.icons8.com/metro/26/000000/r.png" alt="My Site Logo" class="themedImage_TMUO themedImage--light_4Vu1"><img src="https://img.icons8.com/metro/26/000000/r.png" alt="My Site Logo" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">Ray</b></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/intro">Hardware</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Dev. Log</a><a href="https://github.com/RaymondBello/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">ðŸŒœ</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">ðŸŒž</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper blog-wrapper blog-tags-post-list-page"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_q+wC thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_9G5K margin-bottom--md">Recent posts</div><ul class="sidebarItemList_6T4b"><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/4">Bits&amp;Bytes-0x04</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/3">Bits&amp;Bytes-0x03</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/2">Bits&amp;Bytes-0x02</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/1">Bits&amp;Bytes-0x01</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><header class="margin-bottom--xl"><h1>4 posts tagged with &quot;embedded-systems&quot;</h1><a href="/blog/tags">View All Tags</a></header><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_d4p0" itemprop="headline"><a itemprop="url" href="/blog/4">Bits&amp;Bytes-0x04</a></h2><div class="blogPostData_-Im+ margin-vert--md"><time datetime="2021-09-22T00:00:00.000Z" itemprop="datePublished">September 22, 2021</time> Â· <!-- -->2 min read</div><div class="row margin-top--md margin-bottom--sm"><div class="col col--6 authorCol_8c0z"><div class="avatar margin-bottom--sm"><a href="https://rayb.tech" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img class="image_9q7L" src="https://avatars.githubusercontent.com/u/61327086?s=400&amp;u=a272b1f5bd6fe11ae11a33668b4b469864bdc003&amp;v=4" alt="Ray Bello"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://rayb.tech" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Ray Bello</span></a></div><small class="avatar__subtitle" itemprop="description">E.E Engineer</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><h2 class="anchor anchorWithStickyNavbar_y2LR" id="matek-inspired-this">Matek inspired this...<a class="hash-link" href="#matek-inspired-this" title="Direct link to heading">â€‹</a></h2><p>I&#x27;ve spent alot of time thinking about an ideal size for my final PCB.
There are currently some contraints that should be taken into account when planning on minimizing cost, maximazing flexibility and adhereing to airframe dimensions.</p><p>I have been doing some research on this topic and I&#x27;ve found that there seems to be a widespread agreement on what an ideal size should be for an onboard flight control system (amongst hobbyists and commercially).</p><p>MatekSys have made numerous flight control boards over the years so its safe to say their designs have been tried and true especially in the hobbyist community. The F405 Wing is probably one of their most popular boards. And I happen to own a couple F405&#x27;s myself.</p><table><thead><tr><th align="center"><img src="http://www.mateksys.com/wp-content/uploads/2018/06/F411-WING_3.jpg" alt="img"></th></tr></thead><tbody><tr><td align="center">F405 Wing (left), F411 Wing (right)</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_y2LR" id="small-big-brother">Small Big Brother<a class="hash-link" href="#small-big-brother" title="Direct link to heading">â€‹</a></h2><p>The F411 Wing is the smaller updated version of the F405 board with all the essentials included. I don&#x27;t own one but I plan on using a layout very similar to the F411 in my own design. The peripherals, connector and solder pad placement are some of the main traits that I plan on trying to carry over into my own design.</p><p>Updates to follow...</p></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_NBRY padding--none margin-left--sm"><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/blog/tags/electronics">electronics</a></li><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/blog/tags/flight-control">flight-control</a></li><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/blog/tags/embedded-systems">embedded-systems</a></li><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/blog/tags/pcb">pcb</a></li></ul></div><div class="col text--right col--3"><a aria-label="Read more about Bits&amp;Bytes-0x04" href="/blog/4"><b>Read More</b></a></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_d4p0" itemprop="headline"><a itemprop="url" href="/blog/3">Bits&amp;Bytes-0x03</a></h2><div class="blogPostData_-Im+ margin-vert--md"><time datetime="2021-09-03T00:00:00.000Z" itemprop="datePublished">September 3, 2021</time> Â· <!-- -->2 min read</div><div class="row margin-top--md margin-bottom--sm"><div class="col col--6 authorCol_8c0z"><div class="avatar margin-bottom--sm"><a href="https://rayb.tech" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img class="image_9q7L" src="https://avatars.githubusercontent.com/u/61327086?s=400&amp;u=a272b1f5bd6fe11ae11a33668b4b469864bdc003&amp;v=4" alt="Ray Bello"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://rayb.tech" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Ray Bello</span></a></div><small class="avatar__subtitle" itemprop="description">E.E Engineer</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><h2 class="anchor anchorWithStickyNavbar_y2LR" id="imu-configuration">IMU Configuration<a class="hash-link" href="#imu-configuration" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_y2LR" id="sequence">Sequence<a class="hash-link" href="#sequence" title="Direct link to heading">â€‹</a></h3><p>Added a step to select the internal 8Mhz oscillator as the clock source</p><div class="codeBlockContainer_J+bg language-c theme-code-block"><div class="codeBlockContent_csEI c"><pre tabindex="0" class="prism-code language-c codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Set MPU9250 Clock Source to use the X Gyro for reference, which is slightly better than the default internal clock source.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// +-----+-----+-----+-----+-----+-----+-----+-----+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// |  7  |  6  |  5  |  4  |  3  |  2  |  1  |  0  |</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// +-----+-----+-----+-----+-----+-----+-----+-----+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// |     |     |     |     |     |   CLKSEL[2:0]   |</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// +-----+-----+-----+-----+-----+-----+-----+-----+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token class-name" style="color:rgb(255, 203, 107)">uint8_t</span><span class="token plain"> buf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">MPU9250_RA_PWR_MGMT_1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> MPU9250_CLOCK_PLL_XGYRO</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">i2c_write_blocking</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">i2c_default</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> this</span><span class="token operator" style="color:rgb(137, 221, 255)">-&gt;</span><span class="token plain">i2c_addr</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> buf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> false</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="font-style:italic">if</span><span class="token macro property"> </span><span class="token macro property expression">defined IMU_VERBOSE_CONFIG</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">printf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;[IMU][CONFIG] wrote %d to MPU9250_RA_PWR_MGMT_1:%d\n&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> buf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> MPU9250_RA_PWR_MGMT_1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="font-style:italic">endif</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">sleep_ms</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">DELAY_BETWEEN_WR_MS</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Added full scale range sensitivity selection for both accelerometer and gyroscope. </p><div class="codeBlockContainer_J+bg language-c theme-code-block"><div class="codeBlockContent_csEI c"><pre tabindex="0" class="prism-code language-c codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Set Gyro full scale range</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// +-----+-----+-----+-----+-----+-----+-----+-----+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// |  7  |  6  |  5  |  4  |  3  |  2  |  1  |  0  |</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// +-----+-----+-----+-----+-----+-----+-----+-----+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// |     |     |     |FS_SEL[1:0]|     |     |     |</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// +-----+-----+-----+-----+-----+-----+-----+-----+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">buf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> MPU9250_GYRO_CONFIG</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">buf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token class-name" style="color:rgb(255, 203, 107)">uint8_t</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">setting</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">gyro_fs_sel </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;&lt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">3</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">i2c_write_blocking</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">i2c_default</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> this</span><span class="token operator" style="color:rgb(137, 221, 255)">-&gt;</span><span class="token plain">i2c_addr</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> buf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> false</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="font-style:italic">if</span><span class="token macro property"> </span><span class="token macro property expression">defined IMU_VERBOSE_CONFIG</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">printf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;[IMU][CONFIG] wrote %d to MPU9250_GYRO_CONFIG:%d\n&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> buf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> MPU9250_GYRO_CONFIG</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="font-style:italic">endif</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">sleep_ms</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">DELAY_BETWEEN_WR_MS</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Set Accel full scale range</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// +-----+-----+-----+-----+-----+-----+-----+-----+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// |  7  |  6  |  5  |  4  |  3  |  2  |  1  |  0  |</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// +-----+-----+-----+-----+-----+-----+-----+-----+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// |     |     |     |AFS_SEL[1:0]|    |     |     |</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// +-----+-----+-----+-----+-----+-----+-----+-----+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">buf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> MPU9250_ACCEL_CONFIG</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">buf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token class-name" style="color:rgb(255, 203, 107)">uint8_t</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">setting</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">accel_fs_sel </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;&lt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">3</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">i2c_write_blocking</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">i2c_default</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> this</span><span class="token operator" style="color:rgb(137, 221, 255)">-&gt;</span><span class="token plain">i2c_addr</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> buf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> false</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="font-style:italic">if</span><span class="token macro property"> </span><span class="token macro property expression">defined IMU_VERBOSE_CONFIG</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">printf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;[IMU][CONFIG] wrote %d to MPU9250_ACCEL_CONFIG:%d\n&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> buf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> MPU9250_ACCEL_CONFIG</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="font-style:italic">endif</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">sleep_ms</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">DELAY_BETWEEN_WR_MS</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="validating-sequence">Validating Sequence<a class="hash-link" href="#validating-sequence" title="Direct link to heading">â€‹</a></h3><div class="codeBlockContainer_J+bg language-json theme-code-block"><div class="codeBlockContent_csEI json"><pre tabindex="0" class="prism-code language-json codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">IMU</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">CONFIG</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> wrote </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"> to MPU9250_RA_PWR_MGMT_1</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token number" style="color:rgb(247, 140, 108)">107</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">IMU</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">CONFIG</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> wrote </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain"> to MPU9250_GYRO_CONFIG</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token number" style="color:rgb(247, 140, 108)">27</span><span class="token plain">         </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// GYRO_250DPS</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">IMU</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">CONFIG</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> wrote </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain"> to MPU9250_ACCEL_CONFIG</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token number" style="color:rgb(247, 140, 108)">28</span><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// ACCEL_2G</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="tasks-contd">Tasks contd.<a class="hash-link" href="#tasks-contd" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_y2LR" id="mpu9250-imu-driver">MPU9250 IMU Driver<a class="hash-link" href="#mpu9250-imu-driver" title="Direct link to heading">â€‹</a></h3><ul class="contains-task-list"><li class="task-list-item"><input type="checkbox" checked="" disabled=""> <strong>Done</strong>: Implement full scale range and gyro sensitivity selection, currently using default settings.</li><li class="task-list-item"><input type="checkbox" checked="" disabled=""> <strong>Done</strong>: Add hardware reset &amp; calibration sequence</li></ul><h3 class="anchor anchorWithStickyNavbar_y2LR" id="attitude-estimation">Attitude Estimation<a class="hash-link" href="#attitude-estimation" title="Direct link to heading">â€‹</a></h3><ul class="contains-task-list"><li class="task-list-item"><input type="checkbox" checked="" disabled=""> <strong>Done</strong>: Refactor the existing attitude estimation algorithm with modularity/flexibility in mind.</li></ul><h2 class="anchor anchorWithStickyNavbar_y2LR" id="defines-used">Defines Used<a class="hash-link" href="#defines-used" title="Direct link to heading">â€‹</a></h2><div class="codeBlockContainer_J+bg language-c++ theme-code-block"><div class="codeBlockContent_csEI c++"><pre tabindex="0" class="prism-code language-c++ codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">#define DELAY_BETWEEN_WR_MS         50        // Delay between I2C writes during configuration</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#define MPU9250_GYRO_CONFIG         0x1B      // Gyro FS_SEL address</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#define MPU9250_ACCEL_CONFIG        0x1C      // Accel AFS_SEL address</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#define MPU9250_CLOCK_PLL_XGYRO 0x01        // Xgyro pll clock </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#define MPU9250_RA_PWR_MGMT_1   0x6B      // Power management register 1 address</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_NBRY padding--none margin-left--sm"><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/blog/tags/electronics">electronics</a></li><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/blog/tags/flight-control">flight-control</a></li><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/blog/tags/embedded-systems">embedded-systems</a></li></ul></div><div class="col text--right col--3"><a aria-label="Read more about Bits&amp;Bytes-0x03" href="/blog/3"><b>Read More</b></a></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_d4p0" itemprop="headline"><a itemprop="url" href="/blog/2">Bits&amp;Bytes-0x02</a></h2><div class="blogPostData_-Im+ margin-vert--md"><time datetime="2021-09-02T00:00:00.000Z" itemprop="datePublished">September 2, 2021</time> Â· <!-- -->One min read</div><div class="row margin-top--md margin-bottom--sm"><div class="col col--6 authorCol_8c0z"><div class="avatar margin-bottom--sm"><a href="https://rayb.tech" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img class="image_9q7L" src="https://avatars.githubusercontent.com/u/61327086?s=400&amp;u=a272b1f5bd6fe11ae11a33668b4b469864bdc003&amp;v=4" alt="Ray Bello"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://rayb.tech" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Ray Bello</span></a></div><small class="avatar__subtitle" itemprop="description">E.E Engineer</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><h2 class="anchor anchorWithStickyNavbar_y2LR" id="tasks-contd">Tasks contd.<a class="hash-link" href="#tasks-contd" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_y2LR" id="mpu9250-imu-driver">MPU9250 IMU Driver<a class="hash-link" href="#mpu9250-imu-driver" title="Direct link to heading">â€‹</a></h3><ul class="contains-task-list"><li class="task-list-item"><input type="checkbox" checked="" disabled=""> <strong>Completed</strong>: Implement full scale range and gyro sensitivity selection, currently using default settings.</li><li class="task-list-item"><input type="checkbox" checked="" disabled=""> <strong>Completed</strong>: Add hardware reset &amp; calibration sequence</li></ul><h3 class="anchor anchorWithStickyNavbar_y2LR" id="attitude-estimation">Attitude Estimation<a class="hash-link" href="#attitude-estimation" title="Direct link to heading">â€‹</a></h3><ul class="contains-task-list"><li class="task-list-item"><input type="checkbox" checked="" disabled=""> <strong>Completed</strong>: Refactor the existing attitude estimation algorithm with modularity/flexibility in mind.</li></ul></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_NBRY padding--none margin-left--sm"><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/blog/tags/electronics">electronics</a></li><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/blog/tags/flight-control">flight-control</a></li><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/blog/tags/embedded-systems">embedded-systems</a></li></ul></div><div class="col text--right col--3"><a aria-label="Read more about Bits&amp;Bytes-0x02" href="/blog/2"><b>Read More</b></a></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_d4p0" itemprop="headline"><a itemprop="url" href="/blog/1">Bits&amp;Bytes-0x01</a></h2><div class="blogPostData_-Im+ margin-vert--md"><time datetime="2021-09-01T00:00:00.000Z" itemprop="datePublished">September 1, 2021</time> Â· <!-- -->One min read</div><div class="row margin-top--md margin-bottom--sm"><div class="col col--6 authorCol_8c0z"><div class="avatar margin-bottom--sm"><a href="https://rayb.tech" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img class="image_9q7L" src="https://avatars.githubusercontent.com/u/61327086?s=400&amp;u=a272b1f5bd6fe11ae11a33668b4b469864bdc003&amp;v=4" alt="Ray Bello"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://rayb.tech" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Ray Bello</span></a></div><small class="avatar__subtitle" itemprop="description">E.E Engineer</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>The system is currently in a stable state with regards to various sensor drivers and core flight logic.
<em>Although</em> there are a lot of tuning modifications that need to be added to the attitude estimation madgwick filter to make it flight worthy...</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="current-tasks">Current tasks<a class="hash-link" href="#current-tasks" title="Direct link to heading">â€‹</a></h2><ul><li>MPU9250 IMU Driver <ul><li><strong>In-Progress</strong>: Implement full scale range and gyro sensitivity selection, currently using default settings.</li><li><strong>Outstanding</strong>: Add hardware reset &amp; calibration sequence</li></ul></li></ul></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_NBRY padding--none margin-left--sm"><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/blog/tags/electronics">electronics</a></li><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/blog/tags/flight-control">flight-control</a></li><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/blog/tags/embedded-systems">embedded-systems</a></li></ul></div><div class="col text--right col--3"><a aria-label="Read more about Bits&amp;Bytes-0x01" href="/blog/1"><b>Read More</b></a></div></footer></article></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Hardware</a></li></ul></div><div class="col footer__col"><div class="footer__title">Contact</div><ul class="footer__items"><li class="footer__item"><a href="https://www.linkedin.com/in/raymond-b-488916189/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog">Dev. Log</a></li><li class="footer__item"><a href="https://github.com/RaymondBello/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2022 Ray Bello.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.fb2dc35f.js"></script>
<script src="/assets/js/main.35de6d16.js"></script>
</body>
</html>